!function(t,i,s){"use strict";function n(t,i){var s;return function(){var n=this,e=arguments;clearTimeout(s),s=setTimeout(function(){s=null,t.apply(n,e)},i)}}function e(t,i){this.container=t,this.settings=s.extend({},a,i),this.maxHeight=this.settings.maxHeight,this.margin=this.settings.margin,this.listeners={resize:s.proxy(n(this.layout,150),this)},this.bound=!1,this.init()}var h="imageWall",a={maxHeight:180,margin:6};e.prototype={init:function(){return this.update(),this},update:function(){var i=this;return s(this.container).imagesLoaded().progress(function(t,i){i.isLoaded||s(i.img).remove()}).always(function(){i.collect(),i.layout(),i.bound||(i.bound=!0,s(t).on("resize",i.listeners.resize))}),this},destroy:function(){s(t).off("resize",this.listeners.resize),s(this.container).removeClass("image-wall-container"),this.container.style.minHeight=null,s(this.images).each(function(){this.style.width=this.style.height=this.style.margin=null,this.style.top=this.style.left=null})},layout:function(){return t.requestAnimationFrame?function(){var i=this;return t.requestAnimationFrame(function(){i.doLayout()}),this}:function(){return this.doLayout(),this}}(),collect:function(){var t=this;this.images=[],this.widths=[],s("img",this.container).each(function(){var i=this.width,s=this.height;s!==t.maxHeight&&(i=Math.floor(i*(t.maxHeight/s))),t.widths.push(i),t.images.push(this)}),this.numImages=this.images.length,s(this.container).addClass("image-wall-container")},doLayout:function(){var t,s,n,e,h,a,o,r,l,u,m,g=i.documentElement,c=g.scrollHeight===g.clientHeight,f=0,d=0,y=[];for(c&&(g.style.overflowY="scroll"),e=this.container.clientWidth,s=n=0;d<this.numImages;){for(h=0,a=0,t=0;e>1.1*a;){if(t=this.widths[f+h++],!t){h--;break}a+=t+2*this.margin}for(o=e/a,r=Math.floor(this.maxHeight*o),a=0,t=0;h>t;)d+=1,s=a,l=Math.floor(this.widths[f+t]*o),a+=l+2*this.margin,m={width:l,height:r,x:s,y:n},y.push(m),t++;e>a&&(u=e-a,l+=u,a+=u),a>e&&(u=a-e,l-=u,a-=u),m.width=l,n+=r+2*this.margin,f+=h}return this.handleOrphans(h,y),this.applyDimensions(y),c&&(g.style.overflowY=null),this},handleOrphans:function(t,i){var s,n,e,h,a=this.numImages-t,o=1.1,r=this.maxHeight*o,l=!1;for(s=a;s<this.numImages;s++)if(n=i[s],n.height>r){l=!0;break}if(l)for(h=0,s=a;s<this.numImages;s++)n=i[s],e=this.maxHeight/n.height,n.height=this.maxHeight,n.width=Math.floor(n.width*e),n.x=h,h+=n.width+2*this.margin},applyDimensions:function(t){var i,s,n=0,e=t.length,h=t[e-1];for(this.container.style.minHeight=h.y+h.height+this.margin+"px",e;e>n;n++)i=t[n],s=this.images[n],s.style.width=i.width+"px",s.style.height=i.height+"px",s.style.margin=this.margin+"px",s.style.top=i.y+"px",s.style.left=i.x+"px"}},s[h]=s.fn[h]=function(t){return"string"==typeof t?(this.each(function(){var i=s.data(this,"plugin_"+h);"destroy"===t&&s.data(this,"plugin_"+h,null),!i instanceof e||["update","destroy","layout"].indexOf(t)>-1&&i[t]()}),this):this instanceof s?this.each(function(){s.data(this,"plugin_"+h)||s.data(this,"plugin_"+h,new e(this,t))}):s.extend(a,t)}}(this,this.document,this.jQuery),function(t,i){"use strict";var s=t.Embobidon;i(function(){i("html").removeClass("no-js").addClass("js"),i(".fancybox").fancybox({padding:0,helpers:{media:{}}}),i.getJSON(s.api.stats,function(t){console.log(t),i(".campaign-amount").html(t.amount),i(".campaign-contributors").html(t.contributors)}),i(".image-wall").imageWall({maxHeight:300})})}(this,this.jQuery);